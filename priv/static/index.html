<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SaveAPet - Encontre seu pet perdido</title>
    <link rel="icon" type="image/x-icon" href="/imgs/icon.ico" />
    <link rel="stylesheet" href="/css/styles.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  </head>
  <body>
    <div id="app">
      <header class="site-header">
        <div class="brand">
          <div class="brand-left">
            <img src="/imgs/logo.png?v=2" alt="SaveAPet" class="logo" onerror="this.style.display='none'" />
            <h1>SaveAPet</h1>
          </div>
          <div class="header-actions">
            <!-- profile and messages buttons will be injected here -->
          </div>
        </div>
      </header>

      <main class="container">
        <section id="auth" class="auth-container">
          <div class="auth-image">
            <img src="/imgs/capa.png" alt="SaveAPet" />
          </div>
          <div class="auth-form-wrapper card">
            <div class="auth-logo">
              <img src="/imgs/logo.png?v=2" alt="Logo" style="height:60px; width:60px; object-fit:contain" />
              <h2>SaveAPet</h2>
            </div>
            <h3 id="auth-title">Entrar</h3>
            <form id="form-auth">
              <input id="name" name="name" placeholder="Seu nome (apenas no cadastro)" />
              <input id="email" name="email" placeholder="Email" />
              <input id="password" name="password" type="password" placeholder="Senha" />
              <!-- additional registration fields -->
              <input id="phone" name="phone" placeholder="Telefone (opcional)" />
              <input id="city" name="city" placeholder="Cidade (opcional)" />
                <div class="row">
                  <button id="btn-submit-auth" type="button" class="btn primary">Entrar</button>
                  <button id="btn-toggle-register" type="button" class="btn link">Ainda n√£o tem conta?</button>
                </div>
                <div style="text-align:center; margin-top:16px; padding-top:16px; border-top:1px solid #e6e6ee">
                  <button id="btn-continue-without-login" type="button" class="btn" style="background:#6b7280; color:white">Seguir sem login</button>
                  <p style="font-size:12px; color:#9ca3af; margin-top:8px">Voc√™ poder√° visualizar pets, mas n√£o poder√° criar posts ou comentar.</p>
                </div>
            </form>
          </div>
        </section>

        <!-- Feed section: sidebar + map + grid -->
        <section id="feed" class="feed-section" style="display:none">
          <!-- Sidebar with filters -->
          <aside id="filters-sidebar" class="filters-sidebar">
            <div class="filters-header">
              <h3>Filtros</h3>
              <button id="btn-clear-filters" class="btn-link">Limpar</button>
            </div>
            
            <div id="filter-info" style="display:none; padding:10px; background:#e0f2fe; border-radius:6px; margin-bottom:12px; font-size:12px; color:#0369a1;">
              üìç Mostrando pets da sua regi√£o
            </div>
            
            <div class="filter-group">
              <label class="filter-label">Tipo de Pet</label>
              <select id="filter-species" class="filter-select">
                <option value="">Todos</option>
                <option value="Cachorro">Cachorro</option>
                <option value="Gato">Gato</option>
                <option value="P√°ssaro">P√°ssaro</option>
                <option value="Outro">Outro</option>
              </select>
            </div>

            <div class="filter-group">
              <label class="filter-label">Cidade</label>
              <input id="filter-city" type="text" class="filter-input" placeholder="Digite a cidade..." />
            </div>

            <div class="filter-group">
              <label class="filter-label">Estado</label>
              <select id="filter-state" class="filter-select">
                <option value="">Todos os Estados</option>
                <option value="AC">Acre</option>
                <option value="AL">Alagoas</option>
                <option value="AP">Amap√°</option>
                <option value="AM">Amazonas</option>
                <option value="BA">Bahia</option>
                <option value="CE">Cear√°</option>
                <option value="DF">Distrito Federal</option>
                <option value="ES">Esp√≠rito Santo</option>
                <option value="GO">Goi√°s</option>
                <option value="MA">Maranh√£o</option>
                <option value="MT">Mato Grosso</option>
                <option value="MS">Mato Grosso do Sul</option>
                <option value="MG">Minas Gerais</option>
                <option value="PA">Par√°</option>
                <option value="PB">Para√≠ba</option>
                <option value="PR">Paran√°</option>
                <option value="PE">Pernambuco</option>
                <option value="PI">Piau√≠</option>
                <option value="RJ">Rio de Janeiro</option>
                <option value="RN">Rio Grande do Norte</option>
                <option value="RS">Rio Grande do Sul</option>
                <option value="RO">Rond√¥nia</option>
                <option value="RR">Roraima</option>
                <option value="SC">Santa Catarina</option>
                <option value="SP">S√£o Paulo</option>
                <option value="SE">Sergipe</option>
                <option value="TO">Tocantins</option>
              </select>
            </div>

            <div class="filter-group">
              <label class="filter-label">Status</label>
              <div class="filter-checkboxes">
                <label class="checkbox-label">
                  <input type="checkbox" value="Perdido" class="filter-status" checked />
                  <span>Perdido</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" value="Encontrado" class="filter-status" checked />
                  <span>Encontrado</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" value="Ado√ß√£o" class="filter-status" checked />
                  <span>Ado√ß√£o</span>
                </label>
              </div>
            </div>

            <button id="btn-apply-filters" class="btn primary" style="width:100%; margin-top:12px">Aplicar Filtros</button>
          </aside>

          <!-- Main content: map + pets grid -->
          <div class="feed-main">
            <!-- Map section -->
            <div id="map-section" class="map-container">
              <div id="map" style="height:400px; width:100%; border-radius:12px"></div>
            </div>
            
            <!-- Grid of pets -->
            <div id="pets" class="pets-grid"></div>
          </div>
        </section>

        <!-- FAB button to create pet -->
        <button id="fab-add-pet" class="fab" style="display:none" title="Criar postagem">+</button>
      </main>

      <!-- Create pet modal -->
      <div id="create-pet-modal" class="modal" style="display:none">
        <div class="modal-content card">
          <button id="btn-close-create-modal" class="close-btn">‚úï</button>
          <h3>Criar postagem</h3>
          <div style="background:#f0f9ff; padding:12px; border-radius:8px; margin-bottom:12px; font-size:14px; color:#0369a1">
            <strong>üìç Localiza√ß√£o:</strong> <span id="location-hint">Clique no mapa ao lado para marcar</span>
          </div>
          <form id="form-report">
            <input name="name" placeholder="Nome do pet" required />
            <div class="row"><input name="species" placeholder="Esp√©cie" /><input name="breed" placeholder="Ra√ßa" /></div>
            <input name="color" placeholder="Cor" />
            <select name="status">
              <option value="Perdido">Perdido</option>
              <option value="Encontrado">Encontrado</option>
              <option value="Ado√ß√£o">Ado√ß√£o</option>
            </select>
            <input name="last_seen_lat" type="hidden" />
            <input name="last_seen_lng" type="hidden" />
            <div class="row">
              <input name="address" placeholder="Endere√ßo (ou clique no mapa)" />
              <button id="btn-geocode" type="button" class="btn">üîç</button>
            </div>
            <input name="reference" placeholder="Refer√™ncia ‚Äî opcional" />
            <div class="row">
              <input name="city" placeholder="Cidade" required />
              <select name="state" required>
                <option value="">Selecione o Estado</option>
                <option value="AC">Acre (AC)</option>
                <option value="AL">Alagoas (AL)</option>
                <option value="AP">Amap√° (AP)</option>
                <option value="AM">Amazonas (AM)</option>
                <option value="BA">Bahia (BA)</option>
                <option value="CE">Cear√° (CE)</option>
                <option value="DF">Distrito Federal (DF)</option>
                <option value="ES">Esp√≠rito Santo (ES)</option>
                <option value="GO">Goi√°s (GO)</option>
                <option value="MA">Maranh√£o (MA)</option>
                <option value="MT">Mato Grosso (MT)</option>
                <option value="MS">Mato Grosso do Sul (MS)</option>
                <option value="MG">Minas Gerais (MG)</option>
                <option value="PA">Par√° (PA)</option>
                <option value="PB">Para√≠ba (PB)</option>
                <option value="PR">Paran√° (PR)</option>
                <option value="PE">Pernambuco (PE)</option>
                <option value="PI">Piau√≠ (PI)</option>
                <option value="RJ">Rio de Janeiro (RJ)</option>
                <option value="RN">Rio Grande do Norte (RN)</option>
                <option value="RS">Rio Grande do Sul (RS)</option>
                <option value="RO">Rond√¥nia (RO)</option>
                <option value="RR">Roraima (RR)</option>
                <option value="SC">Santa Catarina (SC)</option>
                <option value="SP">S√£o Paulo (SP)</option>
                <option value="SE">Sergipe (SE)</option>
                <option value="TO">Tocantins (TO)</option>
              </select>
            </div>
            <input name="country" placeholder="Pa√≠s" value="Brasil" />
            <input type="date" name="date_lost" placeholder="Data perdido" />
            <textarea name="description" placeholder="Descri√ß√£o"></textarea>
            <div class="file-input-wrapper">
              <input type="file" name="photo" accept="image/*" id="photo-input" />
              <label for="photo-input" class="file-input-label">
                üì∑ Escolher foto
              </label>
              <span id="file-name" class="file-name"></span>
            </div>
            <button id="btn-submit-report" class="btn primary" type="button">Publicar</button>
          </form>
        </div>
      </div>

      <!-- Pet details modal (view pet + comments) -->
      <div id="pet-detail-modal" class="modal" style="display:none">
        <div class="modal-content card modal-large">
          <button id="btn-close-pet-detail" class="close-btn">‚úï</button>
          <div class="modal-scroll-content">
            <div id="pet-detail-content"></div>
            <hr style="margin:20px 0; border:none; border-top:1px solid #e6e6ee"/>
            <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px">
              <h4 style="margin:0; color:#374151">üí¨ Coment√°rios</h4>
              <span id="comments-count" style="font-size:12px; color:#6b7280; background:#f3f4f6; padding:2px 8px; border-radius:12px"></span>
            </div>
            <div id="pet-detail-comments"></div>
            <textarea id="pet-detail-comment-input" placeholder="Escreva um coment√°rio..." style="resize:vertical; min-height:60px"></textarea>
            <div class="row"><button id="btn-add-pet-comment" class="btn primary">Comentar</button></div>
          </div>
        </div>
      </div>

      <!-- message modal -->
      <div id="msg-modal" class="modal" style="display:none">
        <div class="modal-content card">
          <h3>Enviar mensagem</h3>
          <div id="msg-to"></div>
          <textarea id="msg-text" placeholder="Escreva sua mensagem"></textarea>
          <div class="row"><button id="btn-send-msg" class="btn primary">Enviar</button><button id="btn-close-msg" class="btn">Fechar</button></div>
        </div>
      </div>

      <!-- messages inbox modal -->
      <!-- <div id="inbox-modal" class="modal" style="display:none">
        <div class="modal-content card">
          <h3>Mensagens</h3>
          <div id="inbox-list" class="inbox-list"></div>
          <div id="conversation" style="margin-top:12px"></div>
          <div class="row"><button id="btn-close-inbox" class="btn">Fechar</button></div>
        </div>
      </div> -->

      <!-- profile modal -->
      <div id="profile-modal" class="modal" style="display:none">
        <div class="modal-content card">
          <h3>Meu perfil</h3>
          <form id="profile-form">
            <input id="profile-name" name="name" placeholder="Nome" />
            <input id="profile-email" name="email" placeholder="Email" />
            <input id="profile-phone" name="phone" placeholder="Telefone" />
            <input id="profile-city" name="city" placeholder="Cidade" />
            <input id="profile-password" name="password" type="password" placeholder="Nova senha (deixe vazio para manter)" />
            <div class="row"><button id="btn-save-profile" class="btn primary" type="button">Salvar</button><button id="btn-close-profile" class="btn" type="button">Fechar</button></div>
          </form>
        </div>
      </div>
    </main>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/js/app.js"></script>
  </body>
</html>
